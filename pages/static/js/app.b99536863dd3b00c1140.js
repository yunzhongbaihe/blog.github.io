webpackJsonp([1],{"1SJc":function(t,n){},"5BFz":function(t,n){},"5BQ8":function(t,n){},"7AgB":function(t,n){},K74n:function(t,n){},"M+JQ":function(t,n){},NHnr:function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var a=e("7+uW"),s={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},staticRenderFns:[]};var i=e("VU/8")({name:"App"},s,!1,function(t){e("1SJc")},null,null).exports,o=e("/ocq"),r={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticClass:"tabbar"},[n("router-link",{class:{active:"/main/home"===this.$route.path},attrs:{to:"/main/home"}},[this._v("首页")]),this._v(" "),n("router-link",{class:{active:"/main/search"===this.$route.path},attrs:{to:"/main/search"}},[this._v("搜索")])],1)},staticRenderFns:[]};var c={name:"Main",components:{TabBar:e("VU/8")({name:"TabBar"},r,!1,function(t){e("M+JQ")},"data-v-234438cb",null).exports}},l={render:function(){var t=this.$createElement,n=this._self._c||t;return n("div",{attrs:{id:"mainPage"}},[n("TabBar"),this._v(" "),n("keep-alive",[this.$route.meta.keepAlive?n("router-view"):this._e()],1),this._v(" "),this.$route.meta.keepAlive?this._e():n("router-view"),this._v(" "),n("audio",{attrs:{id:"audioBox",preload:"auto"}})],1)},staticRenderFns:[]};var d=e("VU/8")(c,l,!1,function(t){e("5BQ8")},null,null).exports,u={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{attrs:{id:"login"}},[this._v("\n  login\n  "+this._s(this.$route.params.name)+"\n")])},staticRenderFns:[]};var g=e("VU/8")({name:"Login"},u,!1,function(t){e("WtBn")},null,null).exports,h={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"category"},t._l(t.songTypeList,function(n,a){return e("a",{key:n.id,class:{active:n.id===Number(t.songType)},attrs:{href:"javascript:void(0);","data-type":n.id},on:{click:function(n){t.songTypeIndex(n)}}},[t._v(t._s(n.text))])}))},staticRenderFns:[]};var p=e("VU/8")({props:["songType"],name:"Category",data:function(){return{songTypeList:[{id:1,text:"新歌榜"},{id:2,text:"热歌榜"},{id:11,text:"摇滚榜"},{id:12,text:"爵士"},{id:16,text:"流行"},{id:21,text:"欧美金曲榜"},{id:22,text:"经典老歌榜"},{id:23,text:"情歌对唱榜"},{id:24,text:"影视金曲榜"},{id:25,text:"网络歌曲榜"}]}},methods:{songTypeIndex:function(t){this.$emit("getChild",t.target.getAttribute("data-type"))}}},h,!1,function(t){e("bz9h")},"data-v-0e5ae008",null).exports,f=new a.a,v={props:["songList","playSondId"],name:"SongsCenter",methods:{sendData:function(t,n,e){f.$emit("isSongCanPlay","true"),$(e.target).hasClass("song-played")?($(e.target).removeClass("song-played").addClass("song-paused"),f.$emit("isSongCanPlay","false")):$(e.target).hasClass("song-paused")?($(e.target).removeClass("song-paused").addClass("song-played"),f.$emit("isSongCanPlay","true")):($("#lrcContent").find("li").removeClass("active"),$("#lrcContent").attr("data-y",0).css("transform","translateY(0)"),this.$emit("getSongsCenterData",t,n))}}},m={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"songlist"},[t._l(t.songList,function(n,a){return e("div",{key:n.song_id,staticClass:"songlist-list",class:{active:t.playSondId===n.song_id}},[e("div",[e("span",{class:{"song-playing":t.playSondId===n.song_id}},[t._v(t._s(n.title)+" "+t._s(n.author))])]),t._v(" "),e("div",[e("a",{staticClass:"song-play-pause",class:{"song-played":t.playSondId===n.song_id},attrs:{href:"javascript:void(0);","data-songid":n.song_id,"data-tinguid":n.ting_uid},on:{click:function(e){t.sendData(n.song_id,n.ting_uid,e)}}})])])}),t._v(" "),t.songList.length?t._e():e("div",{staticClass:"song-no-played"})],2)},staticRenderFns:[]};var y=e("VU/8")(v,m,!1,function(t){e("5BFz")},"data-v-6c87070e",null).exports,_={props:["singerData","songLrcData","songLink","playSondId"],name:"SongInfo",data:function(){return{lrcData:[],audioBox:null,autoTimer:null}},watch:{songLrcData:function(t,n){this.lrcData=this.analysisLrc(t.lrcContent)},songLink:function(t,n){this.audioBox.src=this.songLink,this.audioBox.play()}},mounted:function(){this.audioBox=document.getElementById("audioBox"),this.lrcContent=document.getElementById("lrcContent");var t=this;f.$on("isSongCanPlay",function(n){"true"===n?(t.audioBox.play(),t.playing()):(clearInterval(t.autoTimer),t.audioBox.pause())})},methods:{analysisLrc:function(t){var n=[];return t.replace(/[\r\n\s&nbsp;]/gim,"").replace(/\[(\d+):(\d+)\.\d+]([^\[]+)?/gim,function(){for(var t=arguments.length,e=Array(t),a=0;a<t;a++)e[a]=arguments[a];var s=e[1],i=e[2],o=e[3];o&&n.push({minutes:s,seconds:i,text:o})}),n},playing:function(){var t=this;clearInterval(t.autoTimer),this.autoTimer=setInterval(function(){var n=t.audioBox.duration,e=t.audioBox.currentTime;t.lyricSpondence(n,e),e>=n&&(clearInterval(t.autoTimer),$(t.lrcContent).find("li").removeClass("active"),$(t.lrcContent).attr("data-y",0).css("transform","translateY(0)"),t.$emit("listPlaySongs"))},1e3)},lyricSpondence:function(t,n){var e=Math.floor(n/60),a=Math.ceil(n-60*e);e<10&&(e="0"+e),a<10&&(a="0"+a);var s=$(this.lrcContent).find("li").filter('[data-minutes="'+e+'"]').filter('[data-seconds="'+a+'"]');if(s.length&&(s.addClass("active").siblings().removeClass("active"),s.index()>=9)){var i=($(this.lrcContent).attr("data-y")||0)-30;$(this.lrcContent).attr("data-y",i).css("transform","translateY("+i+"px)")}}}},x={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"song-info"},[e("div",{staticClass:"song-info-siger"},[e("p",[t._v("歌手信息")]),t._v(" "),e("p",{staticClass:"siger-logo"},[t.singerData.avatar_s1000?e("img",{attrs:{src:t.singerData.avatar_s1000,alt:"歌手照片",width:"100"}}):t._e()]),t._v(" "),e("p",[t._v("地区："+t._s("香港"===t.singerData.country||"澳门"===t.singerData.country||"台湾"===t.singerData.country?"中国"+t.singerData.country:t.singerData.country))]),t._v(" "),e("p",[t._v("姓名："+t._s(t.singerData.name))]),t._v(" "),e("p",[t._v("公司："+t._s(t.singerData.company))]),t._v(" "),e("p",[t._v("生日："+t._s(t.singerData.birth))]),t._v(" "),e("p",{staticStyle:{height:"300px",overflow:"hidden"}},[t._v("简介："+t._s(t.singerData.intro))]),t._v(" "),t.singerData.ting_uid?t._e():e("div",{staticClass:"song-no-played"})]),t._v(" "),e("div",{staticClass:"song-info-lrc"},[e("p",[t._v(t._s(t.songLrcData.title?t.songLrcData.title:"歌词信息"))]),t._v(" "),e("div",{staticClass:"lrc-content-wrap"},[e("ul",{staticClass:"lrc-content",attrs:{id:"lrcContent"}},t._l(t.lrcData,function(n){return e("li",{attrs:{"data-minutes":n.minutes,"data-seconds":n.seconds}},[t._v(t._s(n.text))])}))]),t._v(" "),t.songLrcData.title?t._e():e("div",{staticClass:"song-no-played"})])])},staticRenderFns:[]};var S=e("VU/8")(_,x,!1,function(t){e("7AgB")},"data-v-4cc279a8",null).exports,C=e("Zrlr"),D=e.n(C),L=e("wxAW"),I=e.n(L),b=e("//Fk"),k=e.n(b),T=e("mtWM"),B=e.n(T),w=function(){function t(n){D()(this,t),this.path=n,this.axios=B.a}return I()(t,[{key:"getServerData",value:function(t){return console.log("%c Fetch.js url："+this.path+"?"+t,"color:#31C27C"),n=this.axios.get(this.path+"?"+t),new k.a(function(t,e){n.then(function(n){return t(n)}).catch(function(t){e(t)})});var n}}]),t}(),E=function(){function t(n){D()(this,t),console.log("home.js homePath："+n),this.fetch=new w(n)}return I()(t,[{key:"getData",value:function(t){return this.fetch.getServerData(t)}}]),t}(),A=null,U={name:"Home",data:function(){return{listIndex:0,playSondId:0,playTingUid:0,songType:1,songSize:19,songOffset:0,songList:[],singerData:{},songLrcData:{},songLink:""}},mounted:function(){A=new E(this.HOME),this.$route.params&&this.$route.params.songs?this.songList=this.$route.params.songs:this.getSongList()},methods:{songTypeIndex:function(t){this.songType=t,this.getSongList()},sendData:function(t,n){this.listIndex=function(t,n){if(!t)return-1;if(!n.length)return-1;for(var e=0;e<n.length;e++){var a=n[e];if("[object Object]"==={}.toString.call(a)){for(var s in a)if(a.hasOwnProperty(s)&&a[s]===t)return e}else if(a===t)return e}return-1}(t,this.songList),this.playSondId=t,this.playTingUid=n,n&&this.getSingerInfo(),this.getSongLrcInfo(),this.playSong()},getSongList:function(){var t=this;A.getData("method=baidu.ting.billboard.billList&type="+this.songType+"&size="+this.songSize+"&offset="+this.songOffset).then(function(n){200===n.status&&(t.songList=n.data.song_list)}).catch(function(n){t.songList=[],console.dir(n)})},getSingerInfo:function(){var t=this;A.getData("method=baidu.ting.artist.getInfo&tinguid="+this.playTingUid).then(function(n){200===n.status&&(t.singerData=n.data)}).catch(function(n){t.singerData={},console.log("%c 获取歌手信息失败","color:#ff0000")})},getSongLrcInfo:function(){var t=this;A.getData("method=baidu.ting.song.lry&songid="+this.playSondId).then(function(n){200===n.status&&(t.songLrcData=n.data)}).catch(function(n){t.songLrcData={},console.log("%c 获取歌曲歌词信息失败","color:#ff0000")})},playSong:function(){var t=this;A.getData("method=baidu.ting.song.play&songid="+this.playSondId).then(function(n){200===n.status&&(t.songLink=n.data.bitrate.file_link)}).catch(function(n){t.songLink="",console.log("%c 获取歌曲链接失败","color:#ff0000")})},listPlaySongs:function(){this.listIndex++,this.listIndex>=this.songList.length&&(this.listIndex=0),this.playSondId=this.songList[this.listIndex].song_id,this.playTingUid=this.songList[this.listIndex].ting_uid,this.playTingUid&&this.getSingerInfo(),this.getSongLrcInfo(),this.playSong(),this.$refs.mySongInfo.playing(),console.log("现在播放第"+(this.listIndex+1)+"首歌")}},components:{Category:p,SongsCenter:y,SongInfo:S}},q={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{attrs:{id:"home"}},[e("Category",{attrs:{"song-type":t.songType},on:{getChild:t.songTypeIndex}}),t._v(" "),e("div",{staticClass:"songs-content"},[e("SongsCenter",{attrs:{"song-list":t.songList,"play-sond-id":t.playSondId},on:{getSongsCenterData:t.sendData}}),t._v(" "),e("SongInfo",{ref:"mySongInfo",attrs:{"singer-data":t.singerData,"song-lrc-data":t.songLrcData,"song-link":t.songLink},on:{listPlaySongs:t.listPlaySongs}})],1)],1)},staticRenderFns:[]};var F=e("VU/8")(U,q,!1,function(t){e("qVpw")},"data-v-1fdd9c8c",null).exports,P=null,R={name:"Search",data:function(){return{query:"",isQueryed:!1}},mounted:function(){P=new E(this.HOME)},beforeRouteEnter:function(t,n,e){t.meta.keepAlive=!0,e()},methods:{queryHandle:function(){var t=this;t.isQueryed=!0,P.getData("method=baidu.ting.search.catalogSug&query="+this.query).then(function(n){if(200===n.status){for(var e=n.data,a=[],s=0;s<e.song.length;s++){var i=e.song[s];i.song_id=i.songid,i.title=i.songname,a.push(i)}t.$router.push({name:"home",params:{songs:a}}),t.songList=a}t.query="",t.isQueryed=!1}).catch(function(t){console.log("%c 搜索歌曲失败","color:#ff0000")})}},beforeRouteLeave:function(t,n,e){t.meta.keepAlive=!this.isQueryed,e()}},V={render:function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"search"},[t._m(0),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.query,expression:"query"}],attrs:{type:"text",placeholder:"请输入搜索关键字"},domProps:{value:t.query},on:{input:function(n){n.target.composing||(t.query=n.target.value)}}}),t._v(" "),e("span",[e("input",{attrs:{type:"button",value:"搜索"},on:{click:function(n){t.queryHandle()}}})])])},staticRenderFns:[function(){var t=this.$createElement,n=this._self._c||t;return n("div",{staticStyle:{"margin-bottom":"10px","text-align":"center"}},[n("img",{attrs:{src:e("rkJR"),width:"100",alt:""}})])}]};var M=e("VU/8")(R,V,!1,function(t){e("K74n")},"data-v-7534586f",null).exports;a.a.use(o.a);var H=new o.a({mode:"history",routes:[{path:"/",redirect:"/main"},{path:"/main",name:"main",component:d,children:[{path:"/main",redirect:"/main/home"},{path:"/main/home",name:"home",component:F,meta:{keepAlive:!0}},{path:"/main/login",name:"login",component:g},{path:"/main/search",name:"search",component:M,meta:{keepAlive:!1}}]}]});a.a.prototype.HOME="/tingapi",a.a.config.productionTip=!1,new a.a({el:"#app",router:H,components:{App:i},template:"<App/>"})},WtBn:function(t,n){},bz9h:function(t,n){},qVpw:function(t,n){},rkJR:function(t,n,e){t.exports=e.p+"static/img/music.icon.c189e17.png"}},["NHnr"]);
//# sourceMappingURL=app.b99536863dd3b00c1140.js.map